@page "/text-utils"
@using tinyutils.Services
@inject TextUtilsService TextService
@inject IJSRuntime JS

@rendermode InteractiveServer

<PageTitle>Text Utilities - tinyutils</PageTitle>

<div class="min-h-screen py-8 px-4 sm:px-6 lg:px-8">
    <div class="max-w-5xl mx-auto">
        <!-- Header Section -->
        <div class="text-center mb-12">
            <div
                class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-teal-100 to-cyan-100 rounded-2xl mb-4 transform hover:rotate-3 transition-transform">
                <!-- Placeholder SVG Icon - Text -->
                <svg class="w-8 h-8 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
            </div>
            <h1
                class="text-4xl sm:text-5xl font-bold bg-gradient-to-r from-teal-600 to-cyan-600 bg-clip-text text-transparent mb-3">
                Text Utilities
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                Your Swiss Army knife for text transformations. Encode, hash, slugify, and more.
            </p>
        </div>

        <!-- Tools Grid -->
        <div class="space-y-6">
            <!-- Base64 Encoder/Decoder -->
            <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="p-6 sm:p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <div
                            class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-2xl font-bold text-gray-900 mb-1">Base64 Encode/Decode</h2>
                            <p class="text-sm text-gray-600">Convert text to Base64 or decode it back to plain text</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="inline-block w-2 h-2 bg-blue-500 rounded-full"></span>
                            Your text
                        </label>
                        <textarea @bind="base64Input" @bind:event="oninput" class="w-full h-32 p-4 border-2 border-gray-200 rounded-2xl font-mono text-sm
                                   focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all
                                   resize-none bg-gradient-to-br from-white to-gray-50"
                            placeholder="Type or paste your text here..."></textarea>
                    </div>

                    <div class="flex flex-wrap gap-3 mb-6">
                        <button @onclick="EncodeBase64"
                            class="px-6 py-3 font-bold text-white rounded-xl shadow-md
                                   bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700
                                   transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg">
                            Encode to Base64
                        </button>
                        <button @onclick="DecodeBase64"
                            class="px-6 py-3 font-bold text-white rounded-xl shadow-md
                                   bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700
                                   transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg">
                            Decode from Base64
                        </button>
                    </div>

                    @if (!string.IsNullOrEmpty(base64Output))
                    {
                        <div class="p-5 bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl border border-green-200">
                            <div class="flex items-start justify-between gap-3 mb-2">
                                <label class="text-sm font-semibold text-green-800 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    Result
                                </label>
                                <button @onclick="() => CopyToClipboard(base64Output)"
                                    class="px-3 py-1 text-xs font-semibold text-green-700 bg-green-100 rounded-lg hover:bg-green-200 transition-colors flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                            <p class="text-sm font-mono break-all text-gray-800 leading-relaxed">@base64Output</p>
                        </div>
                    }

                    @if (!string.IsNullOrEmpty(base64Error))
                    {
                        <div class="p-5 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-2xl">
                            <div class="flex items-start gap-3">
                                <svg class="w-5 h-5 text-red-600 mt-0.5 flex-shrink-0" fill="currentColor"
                                    viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"
                                        clip-rule="evenodd" />
                                </svg>
                                <p class="text-red-800 font-medium text-sm">@base64Error</p>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Slugify -->
            <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="p-6 sm:p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <div
                            class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-2xl font-bold text-gray-900 mb-1">Slugify</h2>
                            <p class="text-sm text-gray-600">Transform any text into clean, URL-friendly slugs</p>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="inline-block w-2 h-2 bg-purple-500 rounded-full"></span>
                            Enter your text
                        </label>
                        <input type="text" @bind="slugInput" @bind:event="oninput" @onkeyup="SlugifyText" class="w-full p-4 border-2 border-gray-200 rounded-2xl text-base
                                   focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all
                                   bg-gradient-to-br from-white to-gray-50"
                            placeholder="My Awesome Blog Post Title!" />
                    </div>

                    @if (!string.IsNullOrEmpty(slugOutput))
                    {
                        <div class="p-5 bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl border border-purple-200">
                            <div class="flex items-start justify-between gap-3 mb-2">
                                <label class="text-sm font-semibold text-purple-800 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    URL-safe slug
                                </label>
                                <button @onclick="() => CopyToClipboard(slugOutput)"
                                    class="px-3 py-1 text-xs font-semibold text-purple-700 bg-purple-100 rounded-lg hover:bg-purple-200 transition-colors flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                            <p class="text-base font-mono text-purple-900 break-all">@slugOutput</p>
                        </div>
                    }
                </div>
            </div>

            <!-- UUID Generator -->
            <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="p-6 sm:p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <div
                            class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-orange-500 to-amber-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-2xl font-bold text-gray-900 mb-1">UUID Generator</h2>
                            <p class="text-sm text-gray-600">Generate unique identifiers for your projects</p>
                        </div>
                    </div>

                    <button @onclick="GenerateUuid"
                        class="px-6 py-3 font-bold text-white rounded-xl shadow-md mb-6
                               bg-gradient-to-r from-orange-600 to-amber-600 hover:from-orange-700 hover:to-amber-700
                               transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg">
                        Generate New UUID
                    </button>

                    @if (!string.IsNullOrEmpty(uuidOutput))
                    {
                        <div class="p-5 bg-gradient-to-br from-orange-50 to-amber-50 rounded-2xl border border-orange-200">
                            <div class="flex items-center justify-between gap-3">
                                <div class="flex-1 min-w-0">
                                    <label class="text-sm font-semibold text-orange-800 flex items-center gap-2 mb-2">
                                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd"
                                                d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                                clip-rule="evenodd" />
                                        </svg>
                                        Your UUID
                                    </label>
                                    <p class="text-base font-mono text-gray-900 break-all">@uuidOutput</p>
                                </div>
                                <button @onclick="() => CopyToClipboard(uuidOutput)"
                                    class="flex-shrink-0 px-4 py-2 text-sm font-semibold text-orange-700 bg-orange-100 rounded-xl hover:bg-orange-200 transition-colors flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Hash Calculator -->
            <div class="bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden">
                <div class="p-6 sm:p-8">
                    <div class="flex items-start gap-4 mb-6">
                        <div
                            class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-2xl font-bold text-gray-900 mb-1">Hash Calculator</h2>
                            <p class="text-sm text-gray-600">Generate cryptographic hashes from your text</p>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="inline-block w-2 h-2 bg-red-500 rounded-full"></span>
                            Text to hash
                        </label>
                        <textarea @bind="hashInput" @bind:event="oninput" class="w-full h-32 p-4 border-2 border-gray-200 rounded-2xl font-mono text-sm
                                   focus:border-red-500 focus:ring-4 focus:ring-red-100 transition-all
                                   resize-none bg-gradient-to-br from-white to-gray-50"
                            placeholder="Enter text to hash..."></textarea>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <span class="inline-block w-2 h-2 bg-pink-500 rounded-full"></span>
                            Algorithm
                        </label>
                        <select @bind="selectedHashAlgorithm" class="block w-full px-4 py-3 border-2 border-gray-200 rounded-2xl text-base
                                   focus:border-red-500 focus:ring-4 focus:ring-red-100 transition-all
                                   bg-gradient-to-br from-white to-gray-50 cursor-pointer">
                            <option value="MD5">MD5 (128-bit)</option>
                            <option value="SHA1">SHA-1 (160-bit)</option>
                            <option value="SHA256">SHA-256 (256-bit) — Recommended</option>
                            <option value="SHA512">SHA-512 (512-bit)</option>
                        </select>
                    </div>

                    <button @onclick="CalculateHash"
                        class="px-6 py-3 font-bold text-white rounded-xl shadow-md mb-6
                               bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700
                               transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] hover:shadow-lg">
                        Calculate Hash
                    </button>

                    @if (!string.IsNullOrEmpty(hashOutput))
                    {
                        <div class="p-5 bg-gradient-to-br from-red-50 to-pink-50 rounded-2xl border border-red-200">
                            <div class="flex items-start justify-between gap-3 mb-2">
                                <label class="text-sm font-semibold text-red-800 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    @selectedHashAlgorithm Hash
                                </label>
                                <button @onclick="() => CopyToClipboard(hashOutput)"
                                    class="px-3 py-1 text-xs font-semibold text-red-700 bg-red-100 rounded-lg hover:bg-red-200 transition-colors flex items-center gap-1">
                                    <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                    Copy
                                </button>
                            </div>
                            <p class="text-xs font-mono break-all text-gray-800 leading-relaxed">@hashOutput</p>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Info Card -->
        <div class="mt-8 bg-gradient-to-br from-teal-50 to-cyan-50 rounded-3xl border border-teal-200 overflow-hidden">
            <div class="p-6 sm:p-8">
                <div class="flex items-start gap-4">
                    <div
                        class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-500 rounded-xl flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h3 class="font-bold text-teal-900 mb-2">Privacy first, always</h3>
                        <p class="text-sm text-teal-800 leading-relaxed">
                            No transformations will be stored.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Fun Footer Note -->
        <div class="text-center mt-8 text-sm text-gray-500">
            <p>Hash responsibly. Encode wisely. Slugify creatively. ✨</p>
        </div>
    </div>
</div>

@code {
    // Base64
    private string base64Input = "";
    private string base64Output = "";
    private string base64Error = "";

    // Slugify
    private string slugInput = "";
    private string slugOutput = "";

    // UUID
    private string uuidOutput = "";

    // Hash
    private string hashInput = "";
    private string hashOutput = "";
    private string selectedHashAlgorithm = "SHA256";

    private void EncodeBase64()
    {
        base64Error = "";
        base64Output = "";
        try
        {
            base64Output = TextService.ToBase64(base64Input);
        }
        catch (Exception ex)
        {
            base64Error = ex.Message;
        }
    }

    private void DecodeBase64()
    {
        base64Error = "";
        base64Output = "";
        try
        {
            base64Output = TextService.FromBase64(base64Input);
        }
        catch (Exception ex)
        {
            base64Error = ex.Message;
        }
    }

    private void SlugifyText()
    {
        if (!string.IsNullOrWhiteSpace(slugInput))
        {
            slugOutput = TextService.Slugify(slugInput);
        }
        else
        {
            slugOutput = "";
        }
    }

    private void GenerateUuid()
    {
        uuidOutput = TextService.GenerateUuid();
    }

    private void CalculateHash()
    {
        hashOutput = "";
        if (!string.IsNullOrWhiteSpace(hashInput))
        {
            hashOutput = TextService.ComputeHash(hashInput, selectedHashAlgorithm);
        }
    }

    private async Task CopyToClipboard(string text)
    {
        try
        {
            await JS.InvokeVoidAsync("navigator.clipboard.writeText", text);
        }
        catch
        {
            // Fallback for browsers that don't support clipboard API
        }
    }
}